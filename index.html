<!doctype html>
<html lang="id" class="h-full">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Laporan Keuangan Kelas VI</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <!-- React & ReactDOM (UMD version for global access) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Standalone -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- PDF Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf-autotable.min.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; transition: background-color 0.3s ease; }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="bg-slate-50 min-h-full">
    <div id="root"></div>

    <script type="text/babel">
        // Mengamankan akses ke React dari window global
        const { useState, useEffect, useMemo, createContext, useContext } = window.React;

        // --- DATA ---
        const STUDENT_NAMES = [
            "ABYAN ELFAHRI AZANI", "AINA CAHAYA KAMILA", "ANABELLA ZIANITA ALIYANOR AGUSTINE",
            "AVIKA AZZAHRA", "BAYU HUDA KURNIAWAN", "DAVIN PUTRA MAULANA",
            "FARICHI AZKA SATRIYO", "GHANI AUFAR HABIBI", "KEISHA ANINDYA SAKHI",
            "MUHAMMAD ILYAS YUNUS", "MUHAMMAD RIZQI ALMEIRA ABDUL ZUMAR", "NAUFAL AGHAM SYAHPUTRA",
            "NAYLA MUAZARARA ULFA ALFIAN", "NOVA ALYA NURFADILA", "RAFA RASENDRIYA CENDANI",
            "RAFA RAYHANAH TABINA", "RAFI FABIAN LOKHESWARA", "RAFIQ DESTUAJI PRAYOGA",
            "RAKA MAHATMA HIDAYAT", "RIZKA SETIYOWATI", "TIARA AKILA AMARILYS",
            "YUMNA SHAFINA RARA DEWI", "ZAIDAN ARIQ PRADITYA RAFIQ", "ARU ZULHA AL FATIH",
            "RAHMAT RAMADHON", "GENDHIS AYU KINANTHI", "DEVI NUR KURNIAWATI"
        ];

        const CATEGORIES = ["LKS", "Sumbangan", "Tabungan", "TKA"];

        // --- COMPONENTS ---
        const SummaryCard = ({ title, amount, color }) => (
            <div className={`p-5 rounded-2xl shadow-sm border-b-4 ${color} bg-white`}>
                <p className="text-xs font-bold text-slate-400 uppercase mb-1 tracking-tight">{title}</p>
                <p className="text-2xl font-extrabold text-slate-800">
                    {new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(amount)}
                </p>
            </div>
        );

        const App = () => {
            const [transactions, setTransactions] = useState(() => {
                const saved = localStorage.getItem('finance_data_6b');
                return saved ? JSON.parse(saved) : [];
            });

            useEffect(() => {
                localStorage.setItem('finance_data_6b', JSON.stringify(transactions));
            }, [transactions]);

            const summary = useMemo(() => {
                const totals = {};
                let grand = 0;
                transactions.forEach(t => {
                    totals[t.kategori] = (totals[t.kategori] || 0) + t.jumlah;
                    grand += t.jumlah;
                });
                return { totals, grand };
            }, [transactions]);

            const handleSubmit = (e) => {
                e.preventDefault();
                const form = e.target;
                const newTx = {
                    id: Date.now(),
                    nama: form.nama.value,
                    kategori: form.kategori.value,
                    jumlah: parseInt(form.jumlah.value),
                    tanggal: form.tanggal.value
                };
                setTransactions([newTx, ...transactions]);
                form.reset();
            };

            const deleteTx = (id) => {
                if(confirm('Hapus transaksi ini?')) {
                    setTransactions(transactions.filter(t => t.id !== id));
                }
            };

            const exportPDF = () => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                doc.setFontSize(18);
                doc.text("LAPORAN KEUANGAN KELAS VI", 14, 20);
                doc.setFontSize(10);
                doc.text(`Total Saldo: Rp ${summary.grand.toLocaleString('id-ID')}`, 14, 28);
                
                doc.autoTable({
                    startY: 35,
                    head: [['No', 'Nama Siswa', 'Kategori', 'Jumlah', 'Tanggal']],
                    body: transactions.map((t, i) => [
                        i + 1, t.nama, t.kategori, `Rp ${t.jumlah.toLocaleString('id-ID')}`, t.tanggal
                    ]),
                    headStyles: { fillColor: [79, 70, 229] }
                });
                doc.save("Laporan_Keuangan_6B.pdf");
            };

            return (
                <div className="max-w-5xl mx-auto p-4 py-10 md:p-10">
                    <header className="mb-10 text-center">
                        <h1 className="text-4xl font-black text-slate-900 tracking-tighter">KEUANGAN 6B</h1>
                        <p className="text-slate-400 font-medium">SDN BENDAHARA KELAS - 2025</p>
                    </header>

                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-10">
                        <SummaryCard title="Total Kas" amount={summary.grand} color="border-indigo-600" />
                        {CATEGORIES.map(cat => (
                            <SummaryCard key={cat} title={cat} amount={summary.totals[cat] || 0} color="border-slate-200" />
                        ))}
                    </div>

                    <div className="bg-white p-8 rounded-3xl shadow-xl shadow-slate-200/50 mb-10 border border-slate-100">
                        <h2 className="text-xl font-bold mb-6 flex items-center gap-2">
                            <span className="w-8 h-8 bg-indigo-600 text-white rounded-lg flex items-center justify-center text-sm">+</span>
                            Transaksi Baru
                        </h2>
                        <form onSubmit={handleSubmit} className="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div className="md:col-span-2">
                                <label className="block text-xs font-bold text-slate-400 mb-2 uppercase">Nama Siswa</label>
                                <input name="nama" list="students" className="w-full bg-slate-50 border-none p-4 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all" placeholder="Cari nama..." required />
                                <datalist id="students">
                                    {STUDENT_NAMES.map(s => <option key={s} value={s} />)}
                                </datalist>
                            </div>
                            <div>
                                <label className="block text-xs font-bold text-slate-400 mb-2 uppercase">Kategori</label>
                                <select name="kategori" className="w-full bg-slate-50 border-none p-4 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none appearance-none" required>
                                    {CATEGORIES.map(c => <option key={c} value={c}>{c}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block text-xs font-bold text-slate-400 mb-2 uppercase">Jumlah (Rp)</label>
                                <input name="jumlah" type="number" className="w-full bg-slate-50 border-none p-4 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="0" required />
                            </div>
                            <div>
                                <label className="block text-xs font-bold text-slate-400 mb-2 uppercase">Tanggal</label>
                                <input name="tanggal" type="date" defaultValue={new Date().toISOString().split('T')[0]} className="w-full bg-slate-50 border-none p-4 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none" required />
                            </div>
                            <div className="flex items-end">
                                <button type="submit" className="w-full bg-indigo-600 text-white font-bold p-4 rounded-xl hover:bg-indigo-700 shadow-lg shadow-indigo-200 transition-all">
                                    Simpan
                                </button>
                            </div>
                        </form>
                    </div>

                    <div className="flex justify-between items-end mb-6">
                        <h2 className="text-2xl font-black text-slate-800 tracking-tight">Riwayat</h2>
                        <button onClick={exportPDF} className="bg-emerald-500 text-white px-6 py-2 rounded-full font-bold text-sm hover:bg-emerald-600 transition-all">
                            Cetak PDF
                        </button>
                    </div>

                    <div className="bg-white rounded-3xl shadow-sm border border-slate-100 overflow-hidden">
                        <table className="w-full text-left border-collapse">
                            <thead>
                                <tr className="bg-slate-50/50 text-slate-400">
                                    <th className="p-5 text-xs font-bold uppercase tracking-wider">Siswa</th>
                                    <th className="p-5 text-xs font-bold uppercase tracking-wider">Kategori</th>
                                    <th className="p-5 text-xs font-bold uppercase tracking-wider text-right">Jumlah</th>
                                    <th className="p-5 text-xs font-bold uppercase tracking-wider text-center">Aksi</th>
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-slate-50">
                                {transactions.length === 0 ? (
                                    <tr>
                                        <td colSpan="4" className="p-20 text-center text-slate-300 font-medium">Belum ada transaksi</td>
                                    </tr>
                                ) : (
                                    transactions.map(t => (
                                        <tr key={t.id} className="group hover:bg-indigo-50/30 transition-colors">
                                            <td className="p-5">
                                                <p className="font-bold text-slate-700">{t.nama}</p>
                                                <p className="text-[10px] text-slate-400 font-medium tracking-widest">{t.tanggal}</p>
                                            </td>
                                            <td className="p-5">
                                                <span className="bg-slate-100 text-slate-600 px-3 py-1 rounded-lg text-[10px] font-black uppercase">{t.kategori}</span>
                                            </td>
                                            <td className="p-5 text-right font-black text-slate-900">
                                                Rp {t.jumlah.toLocaleString('id-ID')}
                                            </td>
                                            <td className="p-5 text-center">
                                                <button onClick={() => deleteTx(t.id)} className="text-slate-300 hover:text-red-500 transition-colors">
                                                    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 mx-auto" viewBox="0 0 20 20" fill="currentColor">
                                                        <path fillRule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clipRule="evenodd" />
                                                    </svg>
                                                </button>
                                            </td>
                                        </tr>
                                    ))
                                )}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        };

        // Render aplikasi setelah DOM siap
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>